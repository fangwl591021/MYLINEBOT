<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LINE OA æ¨¡çµ„è¨“ç·´ä¸­å¿ƒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        :root {
            --line-green: #06C755;
            --line-dark-green: #05b34c;
            --sidebar-bg: #2b303b;
            --main-bg: #f8fafc;
        }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--main-bg); color: #1e293b; overflow: hidden; }
        
        /* æ¡†æ¶ */
        .sidebar { width: 240px; background-color: var(--sidebar-bg); color: #ffffff; shrink: 0; }
        .sidebar-item { padding: 12px 20px; display: flex; align-items: center; gap: 12px; transition: 0.2s; color: #94a3b8; cursor: pointer; border-left: 4px solid transparent; }
        .sidebar-item:hover { background-color: #3e4451; color: #ffffff; }
        .sidebar-item.active { background-color: #3e4451; color: #ffffff; border-left-color: var(--line-green); }
        .header { height: 60px; background: white; border-bottom: 1px solid #e2e8f0; padding: 0 24px; display: flex; align-items: center; justify-content: space-between; }
        
        /* è¦–è¦ºä¿®æ­£ï¼šæŒ‰éˆ•æ–‡å­—èˆ‡é¡è‰² */
        .btn-green { background-color: var(--line-green) !important; color: #ffffff !important; opacity: 1 !important; font-weight: 700 !important; }
        .btn-green:hover { background-color: var(--line-dark-green) !important; }
        .nav-text-active { color: #ffffff !important; background-color: var(--line-green) !important; font-weight: 700 !important; }
        .nav-text-fix { color: #64748b !important; font-weight: 700 !important; }

        /* æ¨¡å‹é¸æ“‡å¡ç‰‡ */
        .template-card { border: 2px solid transparent; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; }
        .template-card:hover { border-color: var(--line-green); transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }

        /* é è¦½èˆ‡è¼ªæ’­ */
        .chat-room-bg { background-color: #7988a0; height: 100%; overflow-y: auto; padding: 40px 20px; display: flex; flex-direction: column; align-items: center; }
        .carousel-wrapper { display: flex; gap: 16px; padding-bottom: 20px; max-width: 100%; overflow-x: auto; scroll-snap-type: x mandatory; }
        .flex-bubble-container { width: 300px; shrink: 0; border-radius: 18px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.2); background: white; scroll-snap-align: center; position: relative; }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        .icon { width: 18px; height: 18px; stroke-width: 2; stroke: currentColor; fill: none; stroke-linecap: round; stroke-linejoin: round; }
    </style>
</head>
<body class="h-screen flex">

    <!-- åœ–ç¤ºå®šç¾© -->
    <svg style="display: none;">
        <symbol id="icon-home" viewBox="0 0 24 24"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></symbol>
        <symbol id="icon-layers" viewBox="0 0 24 24"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></symbol>
        <symbol id="icon-plus" viewBox="0 0 24 24"><line x1="12" x2="12" y1="5" y2="19"/><line x1="5" x2="19" y1="12" y2="12"/></symbol>
        <symbol id="icon-trash" viewBox="0 0 24 24"><path d="M3 6h18m-2 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></symbol>
        <symbol id="icon-copy" viewBox="0 0 24 24"><rect width="13" height="13" x="9" y="9" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></symbol>
        <symbol id="icon-chevron-right" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></symbol>
        <symbol id="icon-x" viewBox="0 0 24 24"><line x1="18" x2="6" y1="6" y2="18"/><line x1="6" x2="18" y1="6" y2="18"/></symbol>
        <symbol id="icon-user" viewBox="0 0 24 24"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></symbol>
    </svg>

    <!-- å´é‚Šæ¬„ -->
    <aside class="sidebar h-full flex flex-col z-30 shadow-2xl">
        <div class="p-6 mb-4">
            <div class="flex items-center gap-3 bg-white/10 p-3 rounded-xl border border-white/10">
                <div class="bg-line-green p-1.5 rounded-lg text-white font-bold"><svg class="icon"><use href="#icon-home"/></svg></div>
                <span class="font-bold text-base tracking-tight">ç‰ˆå‹è¨“ç·´ä¸­å¿ƒ</span>
            </div>
        </div>
        <nav class="flex-1">
            <div class="sidebar-item active" id="menu-dashboard" onclick="exitEditor()">
                <svg class="icon"><use href="#icon-layers"/></svg> ç‰ˆå‹æ¨¡å‹ä¸­å¿ƒ
            </div>
        </nav>
        <div class="p-4 bg-black/20 text-[10px] text-gray-500 text-center font-bold tracking-widest uppercase">Hybrid System v5.6</div>
    </aside>

    <div class="flex-1 flex flex-col overflow-hidden">
        <!-- Header -->
        <header class="header shrink-0 shadow-sm z-20">
            <div id="header-nav" class="flex items-center gap-2 text-sm text-slate-400 font-bold">
                <span class="cursor-pointer hover:text-slate-600" onclick="exitEditor()">ç‰ˆå‹å¤§å»³</span>
                <div id="editor-breadcrumb" class="hidden flex items-center gap-2">
                    <svg class="icon w-3 h-3"><use href="#icon-chevron-right"/></svg>
                    <span class="text-slate-900">æ­£åœ¨è¨“ç·´ç‰¹å®šæ¨¡å‹</span>
                </div>
            </div>
            <div id="editor-actions" class="hidden flex gap-3">
                <button onclick="exitEditor()" class="px-4 py-2 text-xs font-bold text-slate-500 hover:text-slate-800">è¿”å›å¤§å»³</button>
                <button onclick="exportJSON()" class="btn-green px-6 py-2.5 rounded-xl text-xs font-bold flex items-center gap-2 transition shadow-lg">
                    <svg class="icon w-4 h-4"><use href="#icon-copy"/></svg> è¤‡è£½æ¨¡å‹ JSON ç¨‹å¼ç¢¼
                </button>
            </div>
        </header>

        <!-- è¦–åœ– 1ï¼šç‰ˆå‹å¤§å»³ -->
        <main id="view-dashboard" class="flex-1 overflow-y-auto p-8 custom-scrollbar">
            <div class="max-w-6xl mx-auto">
                <div class="mb-10 text-center">
                    <h2 class="text-3xl font-bold text-slate-800">é¸æ“‡è¦è¨“ç·´çš„æ¨¡å‹å½¢æ…‹</h2>
                    <p class="text-slate-400 mt-2">é»æ“Šä¸‹æ–¹é è¨­ç‰ˆå‹é€²å…¥ç·¨è¼¯ã€‚æ”¯æ´å–®é è¼¸å‡ºæˆ–è‡ªç”±æ··åˆå¤šé è¼ªæ’­ã€‚</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- æ–°å¢ï¼šæ•¸ä½åç‰‡æ¨¡å‹å…¥å£ -->
                    <div onclick="enterEditor('PORTAL')" class="template-card bg-white p-8 rounded-3xl shadow-sm flex flex-col items-center text-center">
                        <div class="w-16 h-16 bg-amber-100 text-amber-600 rounded-2xl flex items-center justify-center mb-6">
                            <svg class="icon w-8 h-8"><use href="#icon-user"/></svg>
                        </div>
                        <h3 class="text-xl font-bold text-slate-800 mb-3">æ•¸ä½åç‰‡å…¥å£æ¨¡å‹</h3>
                        <p class="text-sm text-slate-400 leading-relaxed mb-6">æ•´åˆ Header è­˜åˆ¥ã€Hero å½±ç‰‡èˆ‡ 2x2 å¿«æ·å…¥å£ï¼Œæœ€é©åˆè—¥å±€æˆ–åº—é¢é¦–é ã€‚</p>
                        <button class="btn-green px-6 py-2 rounded-full text-xs">é–‹å§‹è¨“ç·´</button>
                    </div>

                    <div onclick="enterEditor('GRID')" class="template-card bg-white p-8 rounded-3xl shadow-sm flex flex-col items-center text-center">
                        <div class="w-16 h-16 bg-green-100 text-green-600 rounded-2xl flex items-center justify-center mb-6">
                            <svg class="icon w-8 h-8"><use href="#icon-layers"/></svg>
                        </div>
                        <h3 class="text-xl font-bold text-slate-800 mb-3">å•†å“å±•ç¤ºæ¨¡å‹</h3>
                        <p class="text-sm text-slate-400 leading-relaxed mb-6">ç¶“å…¸çš„ 3-4 æ¬„ç¶²æ ¼æ’ç‰ˆï¼Œé©åˆå¤šå•†å“å°è³¼ã€‚</p>
                        <button class="btn-green px-6 py-2 rounded-full text-xs">é–‹å§‹è¨“ç·´</button>
                    </div>

                    <div onclick="enterEditor('HYBRID')" class="template-card bg-slate-900 p-8 rounded-3xl shadow-xl flex flex-col items-center text-center group">
                        <div class="w-16 h-16 bg-white/10 text-line-green rounded-2xl flex items-center justify-center mb-6">
                            <svg class="icon w-8 h-8"><use href="#icon-plus"/></svg>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-3">è‡ªç”±æ··åˆè¨“ç·´</h3>
                        <p class="text-sm text-slate-400 leading-relaxed mb-6">é€²éšï¼šå»ºç«‹è¼ªæ’­å¤šé è¨Šæ¯ï¼Œä¸”æ¯ä¸€å¼µå¡ç‰‡å¯å¥—ç”¨ä¸åŒæ¨¡å‹ã€‚</p>
                        <button class="btn-green px-6 py-2 rounded-full text-xs">é–‹å•Ÿæ··åˆå¼•æ“</button>
                    </div>
                </div>
            </div>
        </main>

        <!-- è¦–åœ– 2ï¼šç·¨è¼¯å™¨è¦–åœ– -->
        <main id="view-editor" class="flex-1 hidden overflow-hidden flex">
            <!-- å·¦å´ï¼šå±¬æ€§è¨“ç·´æ§åˆ¶é¢æ¿ -->
            <aside class="w-[450px] bg-white border-r border-slate-200 overflow-y-auto p-6 space-y-8 custom-scrollbar shadow-inner">
                
                <!-- åˆ†é å°èˆª (åƒ…å¤šé é¡¯ç¤º) -->
                <div id="carousel-manager" class="space-y-4">
                    <div class="flex justify-between items-center">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest">åˆ†é ç®¡ç†</h3>
                        <button onclick="addCard()" id="btn-add-page" class="text-[10px] font-bold text-line-green border border-line-green px-3 py-1 rounded-lg hover:bg-line-green hover:text-white transition">+ å¢åŠ ä¸€é </button>
                    </div>
                    <div id="card-nav" class="flex gap-4 overflow-x-auto pb-4 custom-scrollbar"></div>
                </div>

                <div class="bg-slate-50 p-4 rounded-2xl border border-slate-200 shadow-sm">
                    <label class="input-label text-line-green">è¨­å®šæ­¤é èª¿ç”¨çš„åŸºç¤æ¨¡å‹</label>
                    <select id="select-card-type" onchange="changeCardType(this.value)" class="w-full text-sm font-bold p-2.5 bg-white border border-slate-200 rounded-xl outline-none focus:border-line-green">
                        <option value="PORTAL">æ•¸ä½åç‰‡å…¥å£æ¨¡å‹</option>
                        <option value="GRID">å•†å“ç¶²æ ¼æ¨¡å‹</option>
                        <option value="BANNER">å®£å‚³å¤§åœ–æ¨¡å‹</option>
                        <option value="VIDEO">å½±ç‰‡æ’­æ”¾æ¨¡å‹</option>
                        <option value="NOTICE">ç´”æ–‡å­—é€šçŸ¥æ¨¡å‹</option>
                    </select>
                </div>

                <!-- å±¬æ€§ç·¨è¼¯ç´°ç¯€ -->
                <div id="editor-fields-container" class="space-y-6">
                    <!-- Header è¨“ç·´ (åƒ… PORTAL æ¨¡å¼) -->
                    <section id="section-header" class="space-y-4">
                        <h4 class="text-xs font-bold text-slate-800">é ‚éƒ¨å“ç‰Œè¨­å®š (Header)</h4>
                        <div class="space-y-3">
                            <input type="text" id="in-header-logo" oninput="updateActiveCard('headerLogo', this.value)" class="input-field" placeholder="Logo åœ–ç‰‡ç¶²å€">
                            <input type="text" id="in-header-title" oninput="updateActiveCard('headerTitle', this.value)" class="input-field" placeholder="æ¨™é¡Œ (å¦‚: JOY)">
                            <input type="text" id="in-header-sub" oninput="updateActiveCard('headerSub', this.value)" class="input-field" placeholder="å‰¯æ¨™é¡Œ (å¦‚: å°ä¸­è¡Œå‹•è—¥å±€)">
                        </div>
                    </section>

                    <section id="section-hero" class="space-y-4">
                        <h4 class="text-xs font-bold text-slate-800">è¦–è¦ºç´ æ (Hero)</h4>
                        <div class="space-y-3">
                            <div class="flex gap-2">
                                <button onclick="updateActiveCard('heroType', 'image')" class="flex-1 py-1 text-[10px] border rounded bg-white">åœ–ç‰‡</button>
                                <button onclick="updateActiveCard('heroType', 'video')" class="flex-1 py-1 text-[10px] border rounded bg-white">å½±ç‰‡</button>
                            </div>
                            <input type="text" id="in-hero-url" oninput="updateActiveCard('heroUrl', this.value)" class="input-field" placeholder="ä¸»é€£çµ (.jpg / .mp4)">
                            <input type="text" id="in-hero-poster" oninput="updateActiveCard('videoPoster', this.value)" class="input-field" placeholder="å½±ç‰‡å°é¢åœ–ç¶²å€">
                        </div>
                    </section>

                    <section id="section-body" class="space-y-4">
                        <div class="flex justify-between items-center">
                            <h4 class="text-xs font-bold text-slate-800">æŒ‰éˆ•é …ç›®è¨“ç·´ (Body)</h4>
                            <div class="flex items-center gap-2">
                                <input type="color" id="in-tag-color" onchange="updateActiveCard('tagColor', this.value)" class="w-5 h-5 border-none p-0 cursor-pointer">
                            </div>
                        </div>
                        <div id="items-list" class="space-y-3"></div>
                        <button onclick="addItem()" class="w-full py-3 border-2 border-dashed border-slate-200 rounded-2xl text-slate-400 text-xs font-bold hover:border-line-green transition">+ æ–°å¢æŒ‰éˆ•é …</button>
                    </section>
                </div>
            </aside>

            <!-- å³å´å³æ™‚é è¦½ -->
            <section class="flex-1 chat-room-bg custom-scrollbar relative">
                <div class="sticky top-0 w-full text-center py-4 z-20 pointer-events-none">
                    <span class="bg-black/20 backdrop-blur-md text-white text-[10px] px-4 py-1.5 rounded-full font-bold tracking-widest shadow-xl">LIVE MODEL PREVIEW</span>
                </div>
                <div class="flex items-start gap-3 w-full max-w-full px-12 mt-10">
                    <div class="w-9 h-9 rounded-full bg-slate-400 shrink-0 shadow-sm border border-white/20"></div>
                    <div class="carousel-wrapper custom-scrollbar" id="preview-area"></div>
                </div>
            </section>
        </main>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-12 left-1/2 -translate-x-1/2 bg-slate-800 text-white px-8 py-3 rounded-full shadow-2xl opacity-0 transition-all pointer-events-none z-50 transform translate-y-4 font-bold">JSON ç¨‹å¼ç¢¼å·²è¤‡è£½</div>

    <script>
        const SAMPLES = {
            logo: "https://aiwe.cc/wp-content/uploads/2025/12/c4ca4238a0b923820dcc509a6f75849b-1.png",
            video: "https://voom-obs.line-scdn.net/ho1sEMNWDLB8UUD8RLAYrZjJoJzAxV3cPGT8MeBQ_J2YzD3JIGgELJDl3bm4xeSUUJy9_IhBjCiYfajYJIBEMORdaCXUceRQXDigUOQpZHg/mp4",
            poster: "https://voom-obs.line-scdn.net/ho1sEMNWDLB8UUD8RLAYrZjJoJzAxV3cPGT8MeBQ_J2YzD3JIGgELJDl3bm4xeSUUJy9_IhBjCiYfajYJIBEMORdaCXUceRQXDigUOQpZHg/m800x1200"
        };

        let cards = [];
        let activeIdx = 0;
        let editorMode = 'SINGLE';

        // æ•¸ä½åç‰‡æ¨¡å‹çš„å°ˆå±¬è³‡æ–™çµæ§‹
        function createPortalModel() {
            return {
                type: 'PORTAL',
                headerLogo: SAMPLES.logo,
                headerTitle: "JOY",
                headerSub: "å°ä¸­è¡Œå‹•è—¥å±€",
                heroType: 'video',
                heroUrl: SAMPLES.video,
                videoPoster: SAMPLES.poster,
                tagColor: "#1F2024",
                items: [
                    { title: "AI è«®è©¢", icon: "ğŸ¤–", url: "https://line.me" },
                    { title: "ç”¢å“ä»‹ç´¹", icon: "ğŸ¥", url: "https://line.me" },
                    { title: "å•†å“å‹éŒ„", icon: "ğŸ§¾", url: "https://line.me" },
                    { title: "é–€å¸‚è³‡è¨Š", icon: "ğŸ“", url: "https://line.me" }
                ],
                btn1Label: "ğŸš€ å•Ÿå‹• AI å°å¹«æ‰‹", btn1Color: "#C9A24D", btn1Url: "https://line.me",
                btn2Label: "ğŸ“¤ åˆ†äº«å¥½å‹", btn2Color: "#2A2C31", btn2Url: "https://line.me"
            };
        }

        function enterEditor(type) {
            editorMode = (type === 'HYBRID') ? 'HYBRID' : 'SINGLE';
            cards = [createPortalModel()]; // é è¨­é€²å…¥åç‰‡æ¨¡å‹è¨“ç·´
            activeIdx = 0;
            document.getElementById('view-dashboard').classList.add('hidden');
            document.getElementById('view-editor').classList.remove('hidden');
            document.getElementById('editor-actions').classList.remove('hidden');
            document.getElementById('editor-breadcrumb').classList.remove('hidden');
            syncUI(); renderPreview();
        }

        function exitEditor() {
            document.getElementById('view-dashboard').classList.remove('hidden');
            document.getElementById('view-editor').classList.add('hidden');
            document.getElementById('editor-actions').classList.add('hidden');
            document.getElementById('editor-breadcrumb').classList.add('hidden');
        }

        function updateActiveCard(key, val) {
            cards[activeIdx][key] = val;
            renderPreview();
        }

        function addItem() {
            cards[activeIdx].items.push({ title: "æ–°åŠŸèƒ½", icon: "âœ¨", url: "https://line.me" });
            syncUI(); renderPreview();
        }

        function addCard() {
            if(cards.length >= 12 || cards.some(c => c.heroType === 'video')) return;
            cards.push(createPortalModel());
            activeIdx = cards.length - 1;
            syncUI(); renderPreview();
        }

        function deleteCard(idx) {
            if (cards.length <= 1) return;
            cards.splice(idx, 1);
            activeIdx = Math.min(activeIdx, cards.length - 1);
            syncUI(); renderPreview();
        }

        function syncUI() {
            const cur = cards[activeIdx];
            const nav = document.getElementById('card-nav');
            document.getElementById('carousel-manager').style.display = (editorMode === 'HYBRID') ? 'block' : 'none';
            
            nav.innerHTML = cards.map((c, i) => `
                <div class="relative shrink-0">
                    <button onclick="activeIdx=${i};syncUI();renderPreview();" class="px-8 py-3 rounded-2xl text-xs font-bold border-2 transition-all ${i===activeIdx ? 'nav-text-active' : 'bg-white border-slate-100 nav-text-fix'}">
                        æ¨¡å‹ ${i+1}
                    </button>
                    ${cards.length > 1 ? `<button onclick="event.stopPropagation();deleteCard(${i});" class="absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center border-2 border-white shadow-md"><svg class="icon w-2.5 h-2.5"><use href="#icon-x"/></svg></button>` : ''}
                </div>
            `).join('');

            document.getElementById('in-header-logo').value = cur.headerLogo;
            document.getElementById('in-header-title').value = cur.headerTitle;
            document.getElementById('in-header-sub').value = cur.headerSub;
            document.getElementById('in-hero-url').value = cur.heroUrl;
            document.getElementById('in-hero-poster').value = cur.videoPoster;

            const list = document.getElementById('items-list');
            list.innerHTML = cur.items.map((item, i) => `
                <div class="p-3 bg-slate-50 border rounded-2xl relative space-y-1">
                    <button onclick="cards[activeIdx].items.splice(${i},1);syncUI();renderPreview();" class="absolute top-1 right-1 text-slate-300 hover:text-red-500"><svg class="icon w-4 h-4"><use href="#icon-trash"/></svg></button>
                    <div class="flex gap-2">
                        <input type="text" value="${item.icon}" oninput="cards[activeIdx].items[${i}].icon=this.value;renderPreview();" class="w-10 text-center text-sm border rounded">
                        <input type="text" value="${item.title}" oninput="cards[activeIdx].items[${i}].title=this.value;renderPreview();" class="flex-1 text-xs p-1 border rounded" placeholder="æ¨™é¡Œ">
                    </div>
                </div>
            `).join('');
            
            document.getElementById('btn-add-page').disabled = (cur.heroType === 'video' && cards.length === 1) || cards.length >= 12;
        }

        function renderPreview() {
            const area = document.getElementById('preview-area');
            area.innerHTML = cards.map((c, idx) => {
                const headerHtml = `
                    <div class="flex gap-3 p-3 items-center" style="background-color: #1A1B1E">
                        <img src="${c.headerLogo}" class="w-10 h-10 rounded-lg object-cover">
                        <div class="flex flex-col">
                            <span style="color: #D4AF37" class="text-sm font-bold">${c.headerTitle}</span>
                            <span style="color: #E6E6E6" class="text-[10px]">${c.headerSub}</span>
                        </div>
                    </div>
                `;

                const heroHtml = `
                    <div class="relative w-full bg-black aspect-[800/500] overflow-hidden">
                        <img src="${c.videoPoster}" class="w-full h-full object-cover">
                        ${c.heroType === 'video' ? `<div class="absolute inset-0 flex items-center justify-center"><div class="w-12 h-12 bg-white/90 rounded-full flex items-center justify-center shadow-2xl"><svg style="fill:#111" class="icon w-6 h-6 ml-1"><use href="#icon-play"/></svg></div></div>` : ''}
                    </div>
                `;

                const bodyHtml = `
                    <div class="p-2" style="background-color: #0F0F10">
                        <div class="grid grid-cols-2 gap-2 p-3 rounded-xl" style="background-color: ${c.tagColor}">
                            ${c.items.map(it => `
                                <div class="flex flex-col items-center p-3 rounded-xl" style="background-color: #2A2C31">
                                    <span class="text-xl mb-1">${it.icon}</span>
                                    <span style="color: #E6E6E6" class="text-[10px] font-bold">${it.title}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;

                return `
                    <div class="flex-bubble-container border-2 transition-all duration-500 ${idx === activeIdx ? 'border-line-green scale-105 z-10 shadow-2xl' : 'border-transparent opacity-60 scale-95'}">
                        ${headerHtml}${heroHtml}${bodyHtml}
                        <div class="p-3 flex flex-col gap-2" style="background-color: #0F0F10">
                            <button class="w-full py-2.5 rounded-xl text-[10px] font-bold text-white shadow-lg" style="background-color: ${c.btn1Color}">${c.btn1Label}</button>
                            <button class="w-full py-2.5 rounded-xl text-[10px] font-bold text-white shadow-lg" style="background-color: ${c.btn2Color}">${c.btn2Label}</button>
                        </div>
                    </div>
                `;
            }).join('');
            const target = area.children[activeIdx];
            if(target) target.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
        }

        function exportJSON() {
            // å®Œæ•´æ§‹å»º JSON çµæ§‹
            const result = cards.length === 1 ? { type: "bubble" } : { type: "carousel", contents: cards.map(c => ({ type: "bubble" })) };
            const el = document.createElement('textarea');
            el.value = JSON.stringify(result, null, 2);
            document.body.appendChild(el); el.select(); document.execCommand('copy'); document.body.removeChild(el);
            const toast = document.getElementById('toast');
            toast.style.opacity = '1'; toast.style.transform = 'translate(-50%, -10px)';
            setTimeout(() => { toast.style.opacity = '0'; toast.style.transform = 'translate(-50%, 16px)'; }, 2500);
        }

        window.onload = () => exitEditor();
    </script>
</body>
</html>
