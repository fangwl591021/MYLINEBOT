<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>名片編輯器</title>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<style>
body {
  background:#0f0f10;
  color:#fff;
  font-family:sans-serif;
  padding:16px;
}
</style>
</head>

<body>
<div id="app">INIT...</div>

<script>
const LIFF_ID = '2008924519-PkufAIve'
const GAS_API_URL = 'https://script.google.com/macros/s/AKfycbyH9GnY0Q2orFoIRxZgU3NzNEeAiQDDQYiwTw814ZFcmMEoBHUXf75mcSM1q25Orgdp/exec'
const token = new URLSearchParams(location.search).get('token')

async function safeInit() {
  try {
    document.getElementById('app').innerText = 'call liff.init'
    await liff.init({ liffId: LIFF_ID })

    document.getElementById('app').innerText = 'liff ready'

    if (!liff.isLoggedIn()) {
      liff.login()
      return
    }

    document.getElementById('app').innerText = 'get profile'
    const profile = await liff.getProfile()

    document.getElementById('app').innerHTML = `
      <h3>LIFF 正常</h3>
      <div>名稱：${profile.displayName}</div>
      <img src="${profile.pictureUrl}" width="80">
      <div>token：${token || 'none'}</div>
    `
  } catch (err) {
    document.getElementById('app').innerHTML =
      '<pre style="color:red">' + err + '</pre>'
  }
}

safeInit()
</script>
</body>
</html>
